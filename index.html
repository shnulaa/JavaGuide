<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>JavaGuide</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Description" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <!--主题-->
    <link rel="stylesheet" href="//unpkg.com/docsify/lib/themes/vue.css" />
  </head>

  <body>
    <nav>
      <!-- 修正了原始 URL 中的拼写错误 hhttps -> https -->
      <a href="https://javaguide.cn/zhuanlan/java-mian-shi-zhi-bei.html"
      >Java面试指北</a>
      <a href="https://javaguide.cn/about-the-author/zhishixingqiu-two-years.html"
        >知识星球</a
      >
    </nav>
    <div id="app"></div>
    <!-- docsify-edit-on-github -->
    <script src="//unpkg.com/docsify-edit-on-github/index.js"></script>
    <script>
      // 离线支持
      if (typeof navigator.serviceWorker !== "undefined") {
        navigator.serviceWorker.register("sw.js");
      }
      window.$docsify = {
        name: "JavaGuide",
        repo: "https://github.com/Snailclimb/JavaGuide",
        maxLevel: 4, //最大支持渲染的标题层级
        //coverpage: true,
        auto2top: true, //切换页面后是否自动跳转到页面顶部
        //ga: 'UA-138586553-1',
        //logo: 'https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-3logo-透明.png' ,
        search: {
          //maxAge: 86400000, // 过期时间，单位毫秒，默认一天
          paths: "auto",
          placeholder: "搜索",
          noData: "找不到结果",
          // 搜索标题的最大程级, 1 - 6
          depth: 3,
        },
        // 备案
        beian: {
          ICP: "鄂ICP备2020015769号",
          NISMSP: {
            number: "",
            url: "",
            id: "",
          },
        },
        // 字数统计
        count: {
          countable: true,
          fontsize: "0.9em",
          color: "rgb(90,90,90)",
          language: "chinese",
        },
        // 新增：在 Markdown 内容渲染到页面后执行的钩子，用于尝试处理图片防盗链
        doneEach: function(html, next) {
          // Docsify 将 Markdown 内容渲染到的主要区域通常是 id="main"。
          // 为了更稳妥，我们先尝试选择 #main，如果不存在，再选择 #app。
          const contentContainer = document.querySelector('#main') || document.querySelector('#app');

          if (contentContainer) {
            // 目标图片域名，根据您之前提到的 `https://oss.javaguide.cn/xingqiu/xingqiu.png`
            // 我们这里针对所有来自 `oss.javaguide.cn` 的图片进行处理。
            // 如果您有其他域名的图片也遇到此问题，可以类似地添加或修改选择器。
            const imagesToProcess = contentContainer.querySelectorAll('img[src^="https://oss.javaguide.cn/"]');
            
            imagesToProcess.forEach(function(img) {
              // 设置 referrerpolicy 为 "no-referrer"
              // 这会阻止浏览器在请求该图片时发送 Referer HTTP 头部
              img.setAttribute('referrerpolicy', 'no-referrer');
              
              // 可选：添加错误处理，以便在图片仍然加载失败时在控制台给出提示
              img.onerror = function() {
                console.warn('图片加载失败 (已尝试 referrerpolicy="no-referrer"):', img.src);
                // 您可以在这里设置一个备用图片，或者隐藏该图片，或者添加一个提示边框等
                // img.style.border = '2px dashed red';
                // img.alt = '图片加载失败';
              };
            });
          }
          
          // 必须调用 next 将处理后的 HTML（或者原始 HTML）传递给下一步
          next(html);
        },
        plugins: [
          EditOnGithubPlugin.create(
            "https://github.com/Snailclimb/JavaGuide/blob/master/"
          ),
          // 您原有的其他插件可以继续放在这里
        ],
      };
    </script>
    <script src="//unpkg.com/docsify/lib/docsify.min.js"></script>
    <!--Java代码高亮-->
    <script src="//unpkg.com/prismjs/components/prism-java.js"></script>
    <!--全文搜索,直接用官方提供的无法生效-->
    <script src="https://cdn.bootcss.com/docsify/4.5.9/plugins/search.min.js"></script>
    <!--谷歌统计
  <script src="//unpkg.com/docsify" data-ga="UA-138586553-1"></script>
  <script src="//unpkg.com/docsify/lib/plugins/ga.js"></script>
  -->
    <!-- 复制到剪贴板 -->
    <script src="//unpkg.com/docsify-copy-code"></script>
    <!-- 图片缩放 -->
    <script src="//unpkg.com/docsify/lib/plugins/zoom-image.js"></script>
    <!-- 表情 -->
    <script src="//unpkg.com/docsify/lib/plugins/emoji.js"></script>
    <!-- 字数统计 -->
    <script src="//unpkg.com/docsify-count/dist/countable.js"></script>
    <!-- 备案 -->
    <script src="https://cdn.jsdelivr.net/npm/docsify-beian@latest/dist/beian.min.js"></script>
  </body>
</html>
